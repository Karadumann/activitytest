<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Activity Bot — Panel</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b1220;
      --panel:#0f1b2d;
      --border:#1f2a44;
      --text:#e5e7eb;
      --muted:#9ca3af;
      --accent:#3b82f6;
      --accent-2:#60a5fa;
      --danger:#ef4444;
      --success:#10b981;
    }
    *{ box-sizing:border-box }
    html, body{ height:100% }
    body{
      margin:0; background:linear-gradient(180deg, #0b1220 0%, #0c1424 100%);
      color:var(--text); font-family:"Inter", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    }
    .container{ max-width:980px; margin:0 auto; padding:32px 20px; }
    header{ display:flex; align-items:center; justify-content:space-between; margin-bottom:22px; }
    header h1{ font-size:20px; font-weight:600; letter-spacing:.2px; margin:0; }
    header .sub{ color:var(--muted); font-size:13px; }
    .status-banner{ display:flex; flex-wrap:wrap; gap:8px; margin-top:8px; }
    .status-badge{ display:inline-flex; align-items:center; gap:6px; padding:4px 8px; border-radius:999px; background:#0a1729; color:#cbd5e1; border:1px solid var(--border); font-size:12px; }
    .dot{ width:8px; height:8px; border-radius:50%; background:var(--danger); }
    .dot.ok{ background:var(--success); }
    .dot.warn{ background:#f59e0b; }
    .status-info{ margin-top:6px; color:var(--muted); font-size:12px; }
    .spinner{ width:14px; height:14px; border:2px solid currentColor; border-top-color:transparent; border-radius:50%; display:inline-block; animation:spin .8s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    .card{
      background:var(--panel); border:1px solid var(--border); border-radius:16px; padding:20px; box-shadow:0 10px 20px rgba(0,0,0,.30); margin-bottom:18px;
    }
    .row{ display:flex; flex-wrap:wrap; gap:16px; align-items:center; margin-bottom:16px; }
    .field{ display:flex; flex-direction:column; gap:6px; min-width:200px; }
    label{ font-size:12px; color:var(--muted); }
    select, input{ height:36px; padding:8px 12px; border-radius:12px; border:1px solid var(--border); background:#0b1628; color:var(--text); outline:none; transition: border-color .2s ease, box-shadow .2s ease; }
    select:focus, input:focus{ border-color:var(--accent); box-shadow:0 0 0 3px rgba(59,130,246,.2); }
    .actions{ display:flex; gap:12px; }
    .btn{ height:36px; padding:0 14px; border-radius:12px; border:1px solid transparent; cursor:pointer; font-weight:600; letter-spacing:.2px; }
    .btn-primary{ background:var(--accent); color:#fff; }
    .btn-primary:hover{ background:var(--accent-2); }
    .btn-secondary{ background:#0b1628; color:var(--text); border-color:var(--border); }
    .btn-secondary:hover{ border-color:var(--accent); color:#fff; }
    .table-wrap{ margin-top:14px; }
    table{ width:100%; border-collapse:collapse; overflow:hidden; border-radius:12px; }
    thead th{ background:#0a1729; color:#cbd5e1; font-weight:600; font-size:13px; padding:10px 12px; border-bottom:1px solid var(--border); }
    tbody td{ padding:10px 12px; border-bottom:1px solid var(--border); }
    tbody tr:hover{ background:#0c1a2e; }
    .badge{ display:inline-block; padding:2px 8px; border-radius:999px; background:#0a1729; color:#cbd5e1; border:1px solid var(--border); font-size:12px; }
    .hr{ height:1px; background:var(--border); border:none; margin:16px 0; }
    footer{ color:var(--muted); font-size:12px; margin-top:14px; }

    
    .modal{ position:fixed; inset:0; background:rgba(0,0,0,.55); display:none; align-items:center; justify-content:center; padding:20px; }
    .modal.show{ display:flex; }
    .modal-content{ background:var(--panel); border:1px solid var(--border); border-radius:16px; width:600px; max-width:100%; box-shadow:0 16px 32px rgba(0,0,0,.35); }
    .modal-header{ padding:14px 16px; border-bottom:1px solid var(--border); display:flex; align-items:center; justify-content:space-between; }
    .modal-title{ font-weight:600; }
    .modal-body{ padding:10px 16px; max-height:50vh; overflow:auto; }
    .modal-actions{ padding:12px 16px; border-top:1px solid var(--border); display:flex; justify-content:flex-end; gap:10px; }
    .channel-item{ padding:10px 12px; border-radius:12px; border:1px solid var(--border); margin-bottom:8px; display:flex; align-items:center; justify-content:space-between; cursor:pointer; }
    .channel-item:hover{ border-color:var(--accent); background:#0c1a2e; }
    .search{ width:100%; margin-bottom:10px; }

    
    .embed-preview{ background:#0a1729; border:1px solid var(--border); border-left:4px solid var(--accent); border-radius:14px; padding:12px; margin-top:16px; }
    .embed-title{ color:#dbeafe; font-weight:600; margin-bottom:8px; }
    .embed-desc{ white-space:pre-wrap; color:#e5e7eb; font-size:13px; line-height:1.5; }

    
    .toast-container{ position:fixed; bottom:16px; right:16px; display:flex; flex-direction:column; gap:8px; z-index:1000; }
    .toast{ background:var(--panel); border:1px solid var(--border); border-left:4px solid var(--accent); color:var(--text); border-radius:12px; padding:10px 12px; box-shadow:0 8px 16px rgba(0,0,0,.35); font-size:13px; min-width:240px; }
    .toast.success{ border-left-color:var(--success); }
    .toast.error{ border-left-color:var(--danger); }
    .toast.info{ border-left-color:var(--accent); }
  </style>
  <script>
    function formatHMS(ms){
      if (!Number.isFinite(ms) || ms <= 0) return '00:00:00';
      const totalSeconds = Math.floor(ms / 1000);
      const h = Math.floor(totalSeconds / 3600);
      const m = Math.floor((totalSeconds % 3600) / 60);
      const s = totalSeconds % 60;
      const pad = (n)=>String(n).padStart(2,'0');
      return `${pad(h)}:${pad(m)}:${pad(s)}`;
    }
    function computeTitle(period, metric, limit){
      const p = period === 'daily' ? 'Daily' : (period === 'weekly' ? 'Weekly' : 'Monthly');
      const m = 'Desired Status Duration';
      return `${p} Top ${limit} (${m})`;
    }
    function showToast(type, message){
      const c = document.getElementById('toastContainer');
      const el = document.createElement('div');
      el.className = `toast ${type}`;
      el.textContent = message;
      c.appendChild(el);
      setTimeout(()=>{
        el.style.opacity = '0';
        el.style.transition = 'opacity .4s ease';
        setTimeout(()=> c.removeChild(el), 400);
      }, 3500);
    }
    const T = {
      hints: {
        bot: { ok: 'Bot session active', bad: 'Not logged in — check DISCORD_TOKEN' },
        guild: { ok: 'Guild cache loaded', bad: 'Check config.guildId & bot invite' },
        intents: { ok: 'Members & Presences enabled', bad: 'Enable GuildMembers & Presences' },
        token: { ok: 'DISCORD_TOKEN set', bad: 'Set DISCORD_TOKEN in .env' },
        auth: { ok: 'PANEL_SECRET required', bad: 'No PANEL_SECRET — public panel' }
      },
      labels: {
        guild: 'Guild',
        port: 'Port',
        reconnecting: 'Reconnecting...',
        reconnect_ok: 'Reconnect requested',
        reconnect_failed: 'Reconnect failed'
      }
    };
    function updatePreview(data){
      const period = document.getElementById('period').value;
      const limit = document.getElementById('limit').value;
      const title = computeTitle(period, 'desired_online', limit);
      const lines = (data || []).map((r, i) => `#${i+1} ${r.name} — ${formatHMS(r.desired_online_ms ?? r.online_ms)}`);
      document.getElementById('previewTitle').textContent = title;
      document.getElementById('previewDesc').textContent = lines.length ? lines.join('\n') : '(no data)';
    }
    let reconnectInProgress = false;
    async function fetchRank(){
      const period = document.getElementById('period').value;
      const metric = 'desired_online';
      const limit = document.getElementById('limit').value;
      const token = document.getElementById('token').value;
      const res = await fetch(`/api/rank?period=${period}&metric=${metric}&limit=${limit}`, {
        headers: token ? { 'X-Panel-Token': token } : {}
      });
      if(!res.ok){ showToast('error','Failed to load rankings'); return; }
      const data = await res.json();
      const tbody = document.querySelector('#table tbody');
      tbody.innerHTML = '';
      data.forEach((r, i) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${i+1}</td><td>${r.name}</td><td>${formatHMS(r.desired_online_ms ?? r.online_ms)}</td><td>${formatHMS(r.online_without_status_ms ?? 0)}</td>`;
        tbody.appendChild(tr);
      });
      updatePreview(data);
      showToast('success',`Loaded ${data.length} items`);
    }
    async function openChannelPicker(){
      const token = document.getElementById('token').value;
      const res = await fetch('/api/channels', { headers: token ? { 'X-Panel-Token': token } : {} });
      if(!res.ok){ showToast('error','Failed to load channels'); return; }
      const channels = await res.json();
      const modal = document.getElementById('modal');
      const list = document.getElementById('channelList');
      const search = document.getElementById('channelSearch');
      list.innerHTML = '';
      search.value = '';
      const render = (items)=>{
        list.innerHTML = '';
        items.forEach(ch => {
          const el = document.createElement('div');
          el.className = 'channel-item';
          el.innerHTML = `<span># ${ch.name}</span><button class="btn btn-primary">Select</button>`;
          el.querySelector('button').addEventListener('click', ()=> sendEmbedToChannel(ch.id));
          list.appendChild(el);
        });
      };
      render(channels);
      search.oninput = () => {
        const q = search.value.toLowerCase();
        render(channels.filter(c => c.name.toLowerCase().includes(q)));
      };
      modal.classList.add('show');
      showToast('info',`Loaded ${channels.length} channels`);
    }
    async function sendEmbedToChannel(channelId){
      const period = document.getElementById('period').value;
      const metric = 'desired_online';
      const limit = document.getElementById('limit').value;
      const token = document.getElementById('token').value;
      showToast('info','Sending embed...');
      const res = await fetch('/api/send_rank_embed', {
        method: 'POST', headers: {
          'Content-Type': 'application/json',
          ...(token ? { 'X-Panel-Token': token } : {})
        }, body: JSON.stringify({ period, metric, limit, channel_id: channelId })
      });
      const modal = document.getElementById('modal');
      modal.classList.remove('show');
      if (res.ok) showToast('success','Embed sent to Discord'); else showToast('error','Send failed');
    }
    // Event Control
    let eventChannelId = null;
    let eventChannelName = '';
    async function openEventChannelPicker(){
      const token = document.getElementById('token').value;
      const res = await fetch('/api/channels', { headers: token ? { 'X-Panel-Token': token } : {} });
      if(!res.ok){ showToast('error','Failed to load channels'); return; }
      const channels = await res.json();
      const modal = document.getElementById('modal');
      const list = document.getElementById('channelList');
      const search = document.getElementById('channelSearch');
      document.getElementById('modalTitle').textContent = 'Select Scoreboard Channel';
      list.innerHTML = '';
      search.value = '';
      const render = (items)=>{
        list.innerHTML = '';
        items.forEach(ch => {
          const el = document.createElement('div');
          el.className = 'channel-item';
          el.innerHTML = `<span># ${ch.name}</span><button class="btn btn-primary">Use</button>`;
          el.querySelector('button').addEventListener('click', ()=> {
            eventChannelId = ch.id; eventChannelName = ch.name;
            modal.classList.remove('show');
            const badge = document.getElementById('eventChannelBadge');
            if (badge) badge.textContent = `# ${eventChannelName}`;
            showToast('success', 'Scoreboard channel selected');
          });
          list.appendChild(el);
        });
      };
      render(channels);
      search.oninput = () => {
        const q = search.value.toLowerCase();
        render(channels.filter(c => c.name.toLowerCase().includes(q)));
      };
      modal.classList.add('show');
      showToast('info',`Loaded ${channels.length} channels`);
    }
    async function fetchEventState(){
      const token = document.getElementById('token').value;
      const res = await fetch('/api/event/state', { headers: token ? { 'X-Panel-Token': token } : {} });
      if(!res.ok) return;
      const s = await res.json();
      const badge = document.getElementById('eventStateBadge');
      const info = document.getElementById('eventStateInfo');
      if (badge) badge.textContent = s.active ? 'Active' : 'Inactive';
      if (info) {
        if (s.active) {
          const ev = s.event;
          info.textContent = `Status: "${ev.statusText}" • Top N: ${ev.limit} • Channel: ${ev.channelId}`;
        } else {
          info.textContent = 'No active event';
        }
      }
    }
    async function startEvent(){
      const token = document.getElementById('token').value;
      const statusText = document.getElementById('eventStatus').value.trim();
      const durationHoursRaw = document.getElementById('eventDuration').value;
      const limit = document.getElementById('eventTopN').value;
      const duration_hours = durationHoursRaw ? Number(durationHoursRaw) : null;
      if (!statusText) { showToast('error','Enter desired status text'); return; }
      const body = { status_text: statusText, duration_hours, limit };
      if (eventChannelId) body.channel_id = eventChannelId;
      const res = await fetch('/api/event/start', {
        method: 'POST', headers: {
          'Content-Type': 'application/json',
          ...(token ? { 'X-Panel-Token': token } : {})
        }, body: JSON.stringify(body)
      });
      if (res.ok) { showToast('success','Event enabled'); fetchEventState(); } else { showToast('error','Enable failed'); }
    }
    async function stopEvent(){
      const token = document.getElementById('token').value;
      const res = await fetch('/api/event/stop', { method: 'POST', headers: { 'Content-Type': 'application/json', ...(token ? { 'X-Panel-Token': token } : {}) } });
      if (res.ok) { showToast('success','Event disabled'); fetchEventState(); } else { showToast('error','Disable failed'); }
    }
    async function exportEvent(){
      const token = document.getElementById('token').value;
      const res = await fetch('/api/event/export', { headers: token ? { 'X-Panel-Token': token } : {} });
      if (!res.ok) { showToast('error','Export failed'); return; }
      const csv = await res.text();
      const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'event_export.csv'; a.click();
      URL.revokeObjectURL(url);
      showToast('success','CSV exported');
    }
    async function resetEvent(){
      const token = document.getElementById('token').value;
      const res = await fetch('/api/event/reset', { method: 'POST', headers: { 'Content-Type': 'application/json', ...(token ? { 'X-Panel-Token': token } : {}) } });
      if (res.ok) { showToast('success','Event times reset'); fetchEventState(); } else { showToast('error','Reset failed'); }
    }
    function onReady(){
      document.getElementById('fetchBtn').addEventListener('click', fetchRank);
      document.getElementById('sendBtn').addEventListener('click', openChannelPicker);
      document.getElementById('modalClose').addEventListener('click', ()=> document.getElementById('modal').classList.remove('show'));
      ['period','limit'].forEach(id => {
        document.getElementById(id).addEventListener('change', ()=> updatePreview([]));
      });
      const es = document.getElementById('eventStartBtn'); if (es) es.addEventListener('click', startEvent);
      const ep = document.getElementById('eventPickChannelBtn'); if (ep) ep.addEventListener('click', openEventChannelPicker);
      const edt = document.getElementById('eventStopBtn'); if (edt) edt.addEventListener('click', stopEvent);
      const exb = document.getElementById('eventExportBtn'); if (exb) exb.addEventListener('click', exportEvent);
      const erb = document.getElementById('eventResetBtn'); if (erb) erb.addEventListener('click', resetEvent);
      const tokenInput = document.getElementById('token');
      const rememberBox = document.getElementById('rememberToken');
      if (tokenInput && rememberBox) {
        const rememberStored = localStorage.getItem('panel_token_remember');
        const remember = rememberStored ? rememberStored === '1' : true; // default ON
        if (!rememberStored) localStorage.setItem('panel_token_remember', '1');
        rememberBox.checked = remember;
        const saved = localStorage.getItem('panel_token') || '';
        tokenInput.value = remember ? saved : '';
        rememberBox.addEventListener('change', (e) => {
          const checked = e.target.checked;
          localStorage.setItem('panel_token_remember', checked ? '1' : '0');
          if (!checked) localStorage.removeItem('panel_token');
        });
        tokenInput.addEventListener('input', (e) => {
          if (rememberBox.checked) localStorage.setItem('panel_token', e.target.value);
        });
      }
      refreshStatus();
      setInterval(refreshStatus, 5000);
      fetchEventState();
      setInterval(fetchEventState, 5000);
      const rb = document.getElementById('reconnectBtn');
      if (rb) rb.addEventListener('click', reconnectBot);
    }
    document.addEventListener('DOMContentLoaded', onReady);

    async function refreshStatus(){
      try{
        const res = await fetch('/api/status');
        if(!res.ok) return;
        const s = await res.json();
        renderStatus(s);
      }catch{}
    }

    function renderStatus(s){
      const banner = document.getElementById('statusBanner');
      const item = (label, ok, hint) => `<span class="status-badge" title="${hint}"><span class="dot ${ok ? 'ok' : ''}"></span>${label}</span>`;
      banner.innerHTML = [
        item('Bot Logged In', !!s.bot_logged_in, s.bot_logged_in ? 'Bot session active' : 'Not logged in — check DISCORD_TOKEN'),
        item('Guild Connected', !!s.guild_connected, s.guild_connected ? 'Guild cache loaded' : 'Check config.guildId & bot invite'),
        item('Intents OK', !!s.intents_ok, s.intents_ok ? 'Members & Presences enabled' : 'Enable GuildMembers & Presences'),
        item('Token Present', !!s.token_present, s.token_present ? 'DISCORD_TOKEN set' : 'Set DISCORD_TOKEN in .env'),
        item('Panel Auth', !!s.panel_auth_enabled, s.panel_auth_enabled ? 'PANEL_SECRET required' : 'No PANEL_SECRET — public panel')
      ].join(' ');

      const info = document.getElementById('statusInfo');
      if (info) info.innerHTML = `<span class="badge">${T.labels.guild}: ${s.guild_id || '-'}</span> <span class="badge">${T.labels.port}: ${s.panel_port || '-'}</span>`;

      const rb = document.getElementById('reconnectBtn');
      if (rb) {
        rb.style.display = (s.token_present && !s.bot_logged_in) ? 'inline-block' : 'none';
        if (!reconnectInProgress) rb.textContent = 'Reconnect Bot';
        rb.disabled = reconnectInProgress;
      }
    }

    async function reconnectBot(){
      try{
        const token = document.getElementById('token').value;
        reconnectInProgress = true;
        const rb = document.getElementById('reconnectBtn');
        if (rb) { rb.disabled = true; rb.innerHTML = `<span class="spinner"></span>Reconnecting...`; }
        showToast('info', 'Reconnecting...');
        const res = await fetch('/api/reconnect', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            ...(token ? { 'X-Panel-Token': token } : {})
          }
        });
        if(res.ok){
          showToast('success', 'Reconnect requested');
          await waitForReady();
        } else {
          showToast('error', 'Reconnect failed');
          reconnectInProgress = false;
          if (rb) { rb.disabled = false; rb.textContent = 'Reconnect Bot'; }
          await refreshStatus();
        }
      }catch{}
    }

    async function waitForReady(maxTries = 10){
      for(let i=0;i<maxTries;i++){
        await new Promise(r=>setTimeout(r,800));
        try{
          const res = await fetch('/api/status');
          if(!res.ok) continue;
          const s = await res.json();
          renderStatus(s);
          if(s.bot_logged_in){
            reconnectInProgress = false;
            const rb = document.getElementById('reconnectBtn');
            if (rb) { rb.disabled = false; rb.textContent = 'Reconnect Bot'; }
            showToast('success', 'Bot reconnected');
            return;
          }
        }catch{}
      }
      reconnectInProgress = false;
      const rb = document.getElementById('reconnectBtn');
      if (rb) { rb.disabled = false; rb.textContent = 'Reconnect Bot'; }
      showToast('error', 'Bot did not become ready');
    }
  </script>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>Activity Bot — Panel</h1>
        <div class="sub">View daily/weekly/monthly rankings and send them as embeds.</div>
        <div id="statusBanner" class="status-banner" aria-live="polite"></div>
        <div id="statusInfo" class="status-info"></div>
        <div class="actions" style="margin-top:8px;">
          <button id="reconnectBtn" class="btn btn-secondary" style="display:none;">Reconnect Bot</button>
        </div>
      </div>
      
    </header>

    <section class="card">
      <div class="row">
        <div class="field">
          <label>Period</label>
          <select id="period">
            <option value="daily">Daily</option>
            <option value="weekly" selected>Weekly</option>
            <option value="monthly">Monthly</option>
          </select>
        </div>
        <div class="field">
          <label>Top N</label>
          <input id="limit" type="number" min="1" max="50" value="10" />
        </div>
        <div class="field" style="flex:1; min-width:240px;">
          <label>Token</label>
          <input id="token" type="password" placeholder="PANEL_SECRET" />
          <label style="display:flex; align-items:center; gap:6px; margin-top:6px;">
            <input id="rememberToken" type="checkbox" checked />
            <span>Remember token</span>
          </label>
        </div>
      </div>
      <div class="actions">
        <button id="fetchBtn" class="btn btn-secondary">Load Rankings</button>
        <button id="sendBtn" class="btn btn-primary">Send Embed to Discord</button>
      </div>
      <div class="hr"></div>
      <div class="embed-preview" aria-label="Embed preview">
        <div id="previewTitle" class="embed-title">Preview</div>
        <div id="previewDesc" class="embed-desc">Use "Load Rankings" to generate the preview.</div>
      </div>
      <div class="table-wrap">
        <table id="table">
          <thead>
            <tr>
              <th>#</th>
              <th>User</th>
              <th>Online w/ Status (h:m:s)</th>
              <th>Online w/o Status (h:m:s)</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>
    <section class="card">
      <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:10px;">
        <div class="modal-title">Event Control</div>
        <div class="badge" id="eventStateBadge">Inactive</div>
      </div>
      <div class="sub" id="eventStateInfo" style="margin-bottom:10px;">No active event</div>
      <div class="row">
        <div class="field" style="flex:2; min-width:240px;">
          <label>Desired Status Text</label>
          <input id="eventStatus" type="text" placeholder="e.g., #work" />
        </div>
        <div class="field" style="min-width:160px;">
          <label>Duration (hours)</label>
          <input id="eventDuration" type="number" min="1" max="168" placeholder="optional" />
        </div>
        <div class="field" style="min-width:140px;">
          <label>Top N</label>
          <input id="eventTopN" type="number" min="1" max="50" value="15" />
        </div>
      </div>
      <div class="row">
        <div class="field" style="flex:1; min-width:240px;">
          <label>Scoreboard Channel</label>
          <div style="display:flex; align-items:center; gap:10px;">
            <button id="eventPickChannelBtn" class="btn btn-secondary">Pick Channel</button>
            <span class="badge" id="eventChannelBadge">(not selected)</span>
          </div>
        </div>
      </div>
      <div class="actions">
        <button id="eventStartBtn" class="btn btn-primary">Enable Event</button>
        <button id="eventStopBtn" class="btn btn-secondary">Disable Event</button>
        <button id="eventExportBtn" class="btn btn-secondary">Export CSV</button>
        <button id="eventResetBtn" class="btn btn-secondary">Reset Times</button>
      </div>
    </section>
    <section class="card">
      <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:10px;">
        <div class="modal-title">Slash Commands</div>
      </div>
      <div style="display:flex; flex-direction:column; gap:10px;">
        <div>
          <label style="display:block; margin-bottom:6px;">For Everyone</label>
          <div class="badge">/mytime</div>
          <div class="sub">Shows your online totals for today/this week/this month. Replies only to you.</div>
        </div>
        <div class="hr"></div>
        <div>
          <label style="display:block; margin-bottom:6px;">Admins</label>
          <div style="display:flex; flex-direction:column; gap:6px;">
            <div>
              <div class="badge">/overview</div>
              <div class="sub">Monitoring overview: monitored count, currently online, non-compliant list. Requires admin role and control channel.</div>
            </div>
            <div>
              <div class="badge">/status user:@mention</div>
              <div class="sub">Member snapshot: online state, custom status, desired status compliance. Requires admin role and control channel.</div>
            </div>
            <div>
              <div class="badge">/report user:@mention [period]</div>
              <div class="sub">Daily/weekly/monthly totals and first 20 sessions. Period choices: <code>daily</code>, <code>weekly</code>, <code>monthly</code>. Requires admin role and control channel.</div>
            </div>
          </div>
        </div>
      </div>
    </section>
    
    <div class="modal" id="modal" aria-hidden="true">
      <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
        <div class="modal-header">
          <div class="modal-title" id="modalTitle">Select a Channel</div>
          <button id="modalClose" class="btn btn-secondary">Close</button>
        </div>
        <div class="modal-body">
          <input id="channelSearch" class="search" type="text" placeholder="Search channels..." />
          <div id="channelList"></div>
        </div>
        <div class="modal-actions">
          <span class="sub">Pick a channel to send the embed.</span>
        </div>
      </div>
    </div>


  </div>
  <div id="toastContainer" class="toast-container" aria-live="polite" aria-atomic="true"></div>
</body>
</html>